<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#3b82f6">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/super-agente-mng-nice/manifest.json">
    
    <!-- 칈cones Apple -->
    <link rel="apple-touch-icon" href="/super-agente-mng-nice/public/icons/apple-touch-icon.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Super Agente MNG">
    
    <!-- Splash Screens para iOS -->
    <link rel="apple-touch-startup-image" 
          href="/super-agente-mng-nice/public/icons/android-chrome-512x512.png"
          media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2)">
    <link rel="apple-touch-startup-image" 
          href="/super-agente-mng-nice/public/icons/android-chrome-512x512.png"
          media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)">
    
    <!-- 칈cones Windows/Android -->
    <meta name="msapplication-TileColor" content="#3b82f6">
    <meta name="msapplication-TileImage" content="/super-agente-mng-nice/public/icons/android-chrome-144x144.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="/super-agente-mng-nice/public/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/super-agente-mng-nice/public/icons/favicon-16x16.png">
    <link rel="shortcut icon" href="/super-agente-mng-nice/public/icons/favicon.ico">
    
    <title>Super Agente MNG NICE</title>
    
    <!-- 游 CDNs MODIFICADAS para Op칞칚o C (H칤brido) -->
    <!-- Tailwind LOCAL (funciona offline) -->
    <link href="/super-agente-mng-nice/public/css/tailwind.min.css" rel="stylesheet">
    
    <!-- Google Fonts com fallback (funciona parcial offline) -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Google Sign-In (SOMENTE online) -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <!-- Custom Styles com fallback para offline -->
    <style>
        /* Fallback font para quando Google Fonts n칚o carregar */
        @font-face {
            font-family: 'JakartaFallback';
            src: local('Arial'), local('Helvetica Neue'), local('Segoe UI'), sans-serif;
        }
        
        body { 
            font-family: 'Plus Jakarta Sans', 'JakartaFallback', sans-serif; 
            -webkit-tap-highlight-color: transparent; 
            overscroll-behavior-y: contain; 
            margin: 0;
            padding: 0;
            background: #ffffff;
        }
        .glass { 
            background: rgba(255, 255, 255, 0.05); 
            backdrop-filter: blur(12px); 
            -webkit-backdrop-filter: blur(12px); 
        }
        .glass-dark { 
            background: rgba(15, 23, 42, 0.6); 
            backdrop-filter: blur(12px); 
            -webkit-backdrop-filter: blur(12px); 
        }
        .safe-bottom { 
            padding-bottom: env(safe-area-inset-bottom); 
        }
        .no-scrollbar::-webkit-scrollbar { 
            display: none; 
        }
        .no-scrollbar { 
            -ms-overflow-style: none; 
            scrollbar-width: none; 
        }
        
        /* SPLASH SCREEN - TELA CHEIA */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            opacity: 1;
            transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        #splash-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        #splash-screen img.splash-logo {
            width: 70vw;
            max-width: 280px;
            height: auto;
            margin-bottom: 24px;
            animation: splashLogoFloat 3s ease-in-out infinite;
            filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.2));
        }
        
        .splash-loading {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-top-color: white;
            border-radius: 50%;
            animation: splashSpin 1s linear infinite;
        }
        
        .splash-title {
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            margin-top: 24px;
            text-align: center;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            padding: 0 20px;
        }
        
        /* 游 TELA DE "SEM INTERNET" (aparece se offline) */
        #offline-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9998;
            color: white;
            text-align: center;
            padding: 20px;
        }
        
        .offline-icon {
            font-size: 3rem;
            margin-bottom: 20px;
        }
        
        .offline-message {
            font-size: 1.2rem;
            margin-bottom: 10px;
            max-width: 300px;
        }
        
        .offline-detail {
            font-size: 0.9rem;
            opacity: 0.8;
            max-width: 300px;
        }
        
        @keyframes splashLogoFloat {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-10px) scale(1.02); }
        }
        
        @keyframes splashSpin {
            to { transform: rotate(360deg); }
        }
        
        /* Previne scroll durante splash */
        body.splash-active {
            overflow: hidden;
            height: 100vh;
        }
    </style>

    <!-- Import Map para CDNs -->
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@19.2.3",
        "react/": "https://esm.sh/react@19.2.3/",
        "react-dom": "https://esm.sh/react-dom@19.2.3",
        "react-dom/": "https://esm.sh/react-dom@19.2.3/",
        "lucide-react": "https://esm.sh/lucide-react@0.562.0",
        "recharts": "https://esm.sh/recharts@3.6.0",
        "localforage": "https://esm.sh/localforage@1.10.0"
      }
    }
    </script>
    <script type="module" crossorigin src="/super-agente-mng-nice/assets/index-DPULid6r.js"></script>
    <link rel="modulepreload" crossorigin href="/super-agente-mng-nice/assets/vendor-uS-d4TUT.js">
    
    <!-- 游 SCRIPT DA SPLASH SCREEN ATUALIZADO -->
    <script>
        // Configura칞칚o da Splash Screen
        const SPLASH_DURATION = 2200; // 2.2 segundos
        const MIN_LOAD_TIME = 1500; // M칤nimo 1.5 segundos
        
        // Inicializa칞칚o
        document.addEventListener('DOMContentLoaded', function() {
            const splashScreen = document.getElementById('splash-screen');
            const offlineScreen = document.getElementById('offline-screen');
            const startTime = Date.now();
            
            // 游 VERIFICA SE EST츼 OFFLINE
            if (!navigator.onLine) {
                // Mostra tela de "Sem Internet" ap칩s um tempo
                setTimeout(() => {
                    splashScreen.style.display = 'none';
                    offlineScreen.style.display = 'flex';
                    
                    // Tenta reconectar a cada 5 segundos
                    setInterval(() => {
                        if (navigator.onLine) {
                            location.reload();
                        }
                    }, 5000);
                }, 3000);
                return;
            }
            
            // Adiciona classe para bloquear scroll
            document.body.classList.add('splash-active');
            
            // Fun칞칚o para esconder splash
            function hideSplash() {
                const elapsed = Date.now() - startTime;
                const remaining = Math.max(MIN_LOAD_TIME - elapsed, 0);
                
                setTimeout(() => {
                    splashScreen.classList.add('hidden');
                    
                    // Remove completamente ap칩s transi칞칚o
                    setTimeout(() => {
                        splashScreen.style.display = 'none';
                        document.body.classList.remove('splash-active');
                    }, 800);
                    
                    // Dispara evento customizado
                    window.dispatchEvent(new CustomEvent('splashHidden'));
                }, remaining);
            }
            
            // Op칞칚o 1: Quando o app React carregar
            if (window.ReactAppLoaded) {
                hideSplash();
            } else {
                // Op칞칚o 2: Fallback - ap칩s tempo determinado
                setTimeout(hideSplash, SPLASH_DURATION);
                
                // Op칞칚o 3: Quando a p치gina terminar de carregar
                window.addEventListener('load', hideSplash);
            }
            
            // Fallback de seguran칞a (nunca mais que 5 segundos)
            setTimeout(() => {
                if (splashScreen.style.display !== 'none') {
                    splashScreen.classList.add('hidden');
                    setTimeout(() => {
                        splashScreen.style.display = 'none';
                        document.body.classList.remove('splash-active');
                    }, 500);
                }
            }, 5000);
            
            // 游 MONITORA MUDAN칂AS DE CONEX츾O
            window.addEventListener('offline', () => {
                const root = document.getElementById('root');
                if (root && root.innerHTML === '') {
                    // App ainda n칚o carregou, mostra tela offline
                    splashScreen.style.display = 'none';
                    offlineScreen.style.display = 'flex';
                }
            });
        });
        
        // Para o app React comunicar que carregou
        window.ReactAppLoaded = false;
        window.addEventListener('reactAppReady', () => {
            window.ReactAppLoaded = true;
        });
    </script>
</head>
<body class="bg-gray-50 antialiased">
    <!-- Splash Screen Tela Cheia -->
    <div id="splash-screen">
        <img src="/super-agente-mng-nice/public/icons/android-chrome-512x512.png" 
             alt="Super Agente MNG" 
             class="splash-logo">
        <div class="splash-loading"></div>
        <div class="splash-title">Super Agente MNG</div>
    </div>
    
    <!-- 游 Tela de "Sem Internet" -->
    <div id="offline-screen">
        <div class="offline-icon">游니</div>
        <div class="offline-message">Conecte-se  Internet</div>
        <div class="offline-detail">
            Este app precisa de conex칚o para carregar funcionalidades completas.
            <br><br>
            <small>Estilo b치sico j치 carregado. Aguardando React e Google Sign-In...</small>
        </div>
    </div>
    
    <!-- App Root -->
    <div id="root"></div>
    
    <!-- Script para notificar quando o React carregar -->
    <script>
        // Monitora quando o script do React carrega
        const reactScript = document.querySelector('script[src*="index-"]');
        if (reactScript) {
            reactScript.addEventListener('load', () => {
                // Aguarda um pouco mais para garantir que React inicializou
                setTimeout(() => {
                    window.dispatchEvent(new CustomEvent('reactAppReady'));
                }, 500);
            });
        }
        
        // Fallback para PWA/APK
        if (window.matchMedia('(display-mode: standalone)').matches || 
            window.navigator.standalone === true) {
            console.log('App rodando em modo standalone (PWA/APK)');
            // Pode adicionar comportamentos espec칤ficos para APK aqui
        }
        
        // 游 DETECTA SE REACT N츾O CARREGOU (offline)
        setTimeout(() => {
            if (!window.ReactAppLoaded && document.getElementById('root').innerHTML === '') {
                console.log('React n칚o carregou - provavelmente offline');
                // N칚o faz nada - a tela offline j치 est치 mostrando
            }
        }, 10000); // Espera 10 segundos
    </script>
</body>
</html>